(function(global){var bSupportJSON=!!(window.JSON&&JSON.parse&&JSON.stringify);var sStateStorageKeyPrefix="state.key_";var fStorage=function(pStorage,sStorageKeyPrefix){var sType="unknown";var sPrefix=sStorageKeyPrefix||sStateStorageKeyPrefix;var oStorage;if(!oStorage||typeof(pStorage)==="string"){sType=pStorage||"session";oStorage=window[sType+"Storage"]}else if(typeof(pStorage)===Object){sType=pStorage.getType?pStorage.getType():"unknown";oStorage=pStorage}var bStorageAvailable=!!oStorage;this.put=function(sId,sStateToStore){if(bStorageAvailable&&sId&&sId.length>0){try{oStorage.setItem(sPrefix+sId,bSupportJSON?JSON.stringify(sStateToStore):sStateToStore);return true}catch(e){return false}}else{return false}};this.get=function(sId){if(bStorageAvailable&&sId&&sId.length>0){try{var sItem=oStorage.getItem(sPrefix+sId);return bSupportJSON?JSON.parse(sItem):sItem}catch(e){return null}}else{return null}};this.remove=function(sId){if(bStorageAvailable&&sId&&sId.length>0){try{oStorage.removeItem(sPrefix+sId);return true}catch(e){return false}}else{return false}};this.clear=function(){if(bStorageAvailable){try{oStorage.clear();return true}catch(e){return false}}else{return false}};this.getType=function(){return sType}};var storageType={local:"local",session:"session",global:"global"};var mStorages={};var storage=function(oStorage){if(!oStorage){oStorage=storageType.session}if(typeof(oStorage)==="string"&&storageType[oStorage]){return mStorages[oStorage]||(mStorages[oStorage]=new fStorage(oStorage))}return new fStorage(oStorage)};global.getStorage=storage})(window);